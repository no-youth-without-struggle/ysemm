<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>借款申请</title>
	</head>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<!-- 引入样式 -->
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<!-- 引入组件库 -->
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<body>
		<div id="app">
			<el-steps :active="active" finish-status="success" description="vertical" simple style="margin-top: 20px">
				<el-step title="借款信息"></el-step>
				<el-step title="抵押物品信息"></el-step>
				<el-step title="完成"></el-step>
			</el-steps>
			<!--借款信息展示-->
			<el-card v-if="active==1" class="box-card" style="width: 95%;height: auto;">
				<el-divider content-position="left" style="color: red;">借款企业信息</el-divider>
				<table class="table table-bordered">
					<tr>
						<td>公司名称：{{company.cname}}</td>
						<td>公司地址：{{company.address}}</td>
						<td>公司电话：{{company.phone}}</td>
					</tr>
					<tr>
						<td>法人名称：{{company.pname}}</td>
						<td>法人性别：{{company.sex}}</td>
						<td>法人电话：{{company.telephone}}</td>
					</tr>
				</table>
				<!--借款信息填写-->
				<el-divider content-position="left" style="color: red;">借款信息填写</el-divider>
				<el-form ref="form" :model="form" label-width="80px">
					<el-row>
						<el-col :span="8">
							<el-form-item label="借款金额">
								<el-input v-model="form.loanMoney" style="width:160px;height: 25px;"></el-input>万
							</el-form-item>
						</el-col>
						<el-col :span="8">
							<el-form-item label="借款类型">
								<el-select v-model="form.loanType" placeholder="请选择借款类型" style="width:160px;height: 25px;;">
									<el-option label="抵押贷" value="抵押贷"></el-option>
								</el-select>
							</el-form-item>
						</el-col>
						<el-col :span="8">
							<el-form-item label="还款方式">
								<el-select v-model="form.repaymentType" placeholder="请选择活动区域" style="width:160px;height: 25px;;">
									<el-option label="等额本金" value="等额本金"></el-option>
									<el-option label="等额本息" value="等额本息"></el-option>
									<el-option label="到期一次还清" value="到期一次还清"></el-option>
								</el-select>
							</el-form-item>
						</el-col>
					</el-row>
					<el-row>
						<el-col :span="8">
							<el-form-item label="借款周期">
								<el-select v-model="form.repaymentTime" @change="rate(form.repaymentTime)" placeholder="请选择活动区域" style="width:160px;height: 25px;">
									<el-option label="3期" value="3"></el-option>
									<el-option label="6期" value="6"></el-option>
									<el-option label="9期" value="9"></el-option>
									<el-option label="12期" value="12"></el-option>
								</el-select>
							</el-form-item>
						</el-col>
						<el-col :span="8">
							<el-form-item label="借款利率">
								<el-input v-model="form.repaymentRate" style="width:160px;height: 25px;"></el-input>
							</el-form-item>
						</el-col>
					</el-row>
					<el-divider content-position="left" style="color: red;">到期后应还</el-divider>
					<table class="table table-bordered">
					<tr>
						<td>应付总金额：{{form.countMoney}}</td>
						<td>应付总利息：{{form.rateMoney}}</td>
					</tr>
				</table>
					
				</el-form>

			</el-card>
			<el-card v-if="active==2" class="box-card" style="width: 100%;height: auto;">
				<el-divider content-position="left" style="color: red;">抵押物信息</el-divider>
				<el-form ref="pledge" :model="pledge" label-width="80px">
					<el-row>
						<el-col :span="8">
							<el-form-item label="物品名称">
								<el-input v-model="pledge.pledgeName" style="width:160px;height: 25px;;"></el-input>
							</el-form-item>
						</el-col>
						<el-col :span="8">
							<el-form-item label="物品类型">
								<el-select v-model="pledge.type" placeholder="请选择物品类型" style="width:160px;height: 25px;;">
									<el-option label="固定资产" value="固定资产"></el-option>
									<el-option label="非固定资产" value="非固定资产"></el-option>
								</el-select>
							</el-form-item>
						</el-col>
						<el-col :span="8">
							<el-form-item label="市场估值">
								<el-input v-model="pledge.valuation" style="width:160px;height: 25px;;"></el-input>万元
							</el-form-item>
						</el-col>
					</el-row>
					<el-form-item label="物品描述" style="width: 60%;">
    						<el-input type="textarea" v-model="pledge.description"></el-input>
  					</el-form-item>
				</el-form>
			</el-card>
			<el-card v-if="active==3" class="box-card" style="width: 100%;height: auto;">

					<span style="color: red">恭喜完成申请，我们将在三天之内完成审核！！！</span>

			</el-card>
			<el-button v-if="active==2" style="margin-top: 12px;" @click="back">上一步</el-button>
			<el-button v-if="active==1" style="margin-top: 12px;" @click="next">下一步</el-button>
			<el-button v-if="active==2" style="margin-top: 12px;" @click="success">完成</el-button>
		</div>
	</body>
	<script src="rate.js"></script>
	<script>
			getRA();
		var app = new Vue({
			el: "#app",
			data: {
				active: 1,
				form: {},
				company:{},
				pledge:{}
			},
			methods: {
				/**
				 * 步骤条
				 */
				back: function() {
					this.active = 1;
				},
				next: function() {
					this.active = 2;
				},
				success: function() {
					this.active = 3;
					axios.post("/homeBorrow/postBorrow",{borrow:this.form,pledge:this.pledge})
							.then(function (result) {
								var msg=result.data;
								if (msg==200){
									app.$message({
										message: msg.msg,
										type: 'success'
									});
								}

							})
				},
				//利率
				rate:function (value) {
					if (value==3){
						this.form.repaymentRate=0.2;
					} else if (value==6){
						this.form.repaymentRate=0.15;
					} else if (value==9){
						this.form.repaymentRate=0.10;
					}else{
						this.form.repaymentRate=0.08;
					}
					/**
					 * 动态计算出总金额和总利息
					 */
					var count;//总金额
					var rate;//总利息
					var time=app.form.repaymentTime;//贷款期数
					var loanmoney= app.form.loanMoney;//贷款总金额
					var loantype=app.form.repaymentType;//还款方式
					var loanrate=app.form.repaymentRate;//还款利率
					var rate1 = getRate(loantype,loanmoney*10000,time,loanrate);
					app.form.countMoney=rate1[2].toFixed(2);
					app.form.rateMoney=rate1[3].toFixed(2)
					console.log(rate1[2]+"："+rate1[3])
				}
			}
		});
		/**
		 * 获取用户的信息
		 */
		axios.post("/homeBorrow/getCompany")
				.then(function (result) {
					app.company=result.data.obj;
				})

	</script>

</html>