<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>小额贷</title>
	<!--先引入vue.js库-->
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<!--axios-->
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<!-- 引入样式 -->
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<!-- 引入组件库 -->
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="icon" href="../layui/favicon.ico">
	<link rel="stylesheet" href="../layui/layui/css/layui.css" media="all" />
	<link rel="stylesheet" href="../layui/css/font_eolqem241z66flxr.css" media="all" />
	<link rel="stylesheet" href="../layui/css/main.css" media="all" />

</head>
<body class="main_body">
<div class="layui-layout layui-layout-admin">
	<!-- 顶部 -->
	<div class="layui-header header">
		<div class="layui-main">
			<a href="#" class="logo">小额贷后台管理系统</a>
			<!-- 搜索 -->
			<div class="layui-form component">
				<select name="modules" lay-verify="required" lay-search="">
					<option value="">直接选择或搜索选择</option>
					<option value="1">layer</option>
					<option value="2">form</option>
					<option value="3">layim</option>
					<option value="4">element</option>
					<option value="5">laytpl</option>
					<option value="6">upload</option>
					<option value="7">laydate</option>
					<option value="8">laypage</option>
					<option value="9">flow</option>
					<option value="10">util</option>
					<option value="11">code</option>
					<option value="12">tree</option>
					<option value="13">layedit</option>
					<option value="14">nav</option>
					<option value="15">tab</option>
					<option value="16">table</option>
					<option value="17">select</option>
					<option value="18">checkbox</option>
					<option value="19">switch</option>
					<option value="20">radio</option>
				</select>
				<i class="layui-icon">&#xe615;</i>
			</div>
			<!-- 天气信息 -->
			<div class="weather" pc>
				<div id="tp-weather-widget"></div>
				<script>(function(T,h,i,n,k,P,a,g,e){g=function(){P=h.createElement(i);a=h.getElementsByTagName(i)[0];P.src=k;P.charset="utf-8";P.async=1;a.parentNode.insertBefore(P,a)};T["ThinkPageWeatherWidgetObject"]=n;T[n]||(T[n]=function(){(T[n].q=T[n].q||[]).push(arguments)});T[n].l=+new Date();if(T.attachEvent){T.attachEvent("onload",g)}else{T.addEventListener("load",g,false)}}(window,document,"script","tpwidget","//widget.seniverse.com/widget/chameleon.js"))</script>
				<script>tpwidget("init", {
					"flavor": "slim",
					"location": "WX4FBXXFKE4F",
					"geolocation": "disabled",
					"language": "zh-chs",
					"unit": "c",
					"theme": "chameleon",
					"container": "tp-weather-widget",
					"bubble": "disabled",
					"alarmType": "badge",
					"color": "#FFFFFF",
					"uid": "U9EC08A15F",
					"hash": "14dff75e7253d3a8b9727522759f3455"
				});
				tpwidget("show");</script>
			</div>
			<!-- 顶部右侧菜单 -->
			<ul class="layui-nav top_menu">
				<li class="layui-nav-item showNotice" id="showNotice" pc>
					<a href="javascript:;"><i class="iconfont icon-gonggao"></i><cite>系统公告</cite></a>
				</li>
				<li class="layui-nav-item" mobile>
					<a href="javascript:;" data-url="page/user/changePwd.html"><i class="iconfont icon-shezhi1" data-icon="icon-shezhi1"></i><cite>设置</cite></a>
				</li>
				<li class="layui-nav-item" mobile>
					<a href="backlogin.html"><i class="iconfont icon-loginout"></i> 退出</a>
				</li>
				<li class="layui-nav-item lockcms" pc>
					<a href="javascript:;"><i class="iconfont icon-lock1"></i><cite>锁屏</cite></a>
				</li>
				<li class="layui-nav-item" pc>
					<a href="javascript:;">
						<img src="../layui/images/face.jpg" class="layui-circle" width="35" height="35">
						<cite>请叫我马哥</cite>
					</a>
					<dl class="layui-nav-child">
						<dd><a href="javascript:;" data-url="reg.html"><i class="iconfont icon-zhanghu" data-icon="icon-zhanghu"></i><cite>个人资料</cite></a></dd>
						<dd><a href="javascript:;" data-url="AuditOne.html"><i class="iconfont icon-shezhi1" data-icon="icon-shezhi1"></i><cite>修改密码</cite></a></dd>
						<dd><a href="javascript:;"><i class="backlogin.html"></i><cite>退出</cite></a></dd>
					</dl>
				</li>
			</ul>
		</div>
	</div>

	<div id="app">
		<el-container>
			<!--<el-header>Header</el-header>-->
			<el-container>
				<el-aside width="200px" class="layui-bg-black">
					<div class="user-photo">
						<a class="img" title="我的头像" ><img src="../layui/images/face.jpg"></a>
						<p>你好！<span class="userName">{{userName}}</span>, 欢迎登录</p>
					</div>
					<el-tree :data="treeData" style="background: bottom;color:white "  default-expand-all @node-click="handleNodeClick"></el-tree>
				</el-aside>
				<el-main>
					<el-tabs v-model="editableTabsValue" type="card" closable @tab-remove="removeTab">
						<el-tab-pane
								v-for="(item, index) in editableTabs"
								:key="item.name"
								:label="item.title"
								:name="item.name">
							<iframe width="100%" style="border: 0px;" height="650px;" :src="item.url"></iframe>
						</el-tab-pane>
					</el-tabs>
				</el-main>
			</el-container>
			<!--<el-footer>Footer</el-footer>-->
		</el-container>
	</div>

	<!-- 底部 -->
	<div class="layui-footer footer">
		<p>copyright @2019 小额贷,轻松贷</p>
	</div>
</div>
<script>

	var vue = new Vue({
		el: "#app",
		data: {
			treeData: [],
			editableTabsValue: '1',
			editableTabs: [{
				title: '首页',
				name: '1',
				url: 'https://www.tmall.com/?ali_trackid=2:mm_26632258_3504122_48284354:1564472597_234_1360245004&clk1=18912da378ca0473c5ceb1f3b85ad8d8&upsid=18912da378ca0473c5ceb1f3b85ad8d8'
			}],
			tabIndex: 1,
			userName:''
		},
		//树形菜单查询
		created: function () {
			var self = this;
			axios.post("/login/getSession")
					.then(function (response) {
						self.userName = response.data.email;
					})
			axios.post("/powers/tree", this.form)
					.then(function (response) {
						self.treeData = response.data;
					})
		},
		methods: {
			handleNodeClick: function (data) {
				if (data.url != null && data.url != 'null' && data.url != '' && data.url != 'undefined') {
					//  console.log(JSON.stringify(data));
					this.addTab(data.label, data.url);
				}
			},
			addTab: function (targetName, url) {
				var oldTabs = JSON.stringify(this.editableTabs);
				//  var newTabName = ++this.tabIndex + '';
				if (oldTabs.indexOf(targetName) == -1) {
					this.editableTabs.push({
						title: targetName,
						name: targetName,
						//content: 'New Tab content'
						url: url
					});
				}
				this.editableTabsValue = targetName;
			},
			removeTab: function (targetName) {
				var tabs = this.editableTabs;
				var activeName = this.editableTabsValue;
				if (activeName === targetName) {
					tabs.forEach(function (tab, index) {
						if (tab.name === targetName) {
							var nextTab = tabs[index + 1] || tabs[index - 1];
							if (nextTab) {
								activeName = nextTab.name;
							}
						}
					});
				}
				this.editableTabsValue = activeName;
				this.editableTabs = tabs.filter(tab => tab.name !== targetName);
			}
		}
	});
</script>
<!-- 移动导航 -->
<div class="site-tree-mobile layui-hide"><i class="layui-icon">&#xe602;</i></div>
<div class="site-mobile-shade"></div>
<script type="text/javascript" src="../layui/js/nav.js"></script>
<script type="text/javascript" src="../layui/js/nav.js"></script>
<script type="text/javascript" src="../layui/js/leftNav.js"></script>
<script type="text/javascript" src="../layui/js/index.js"></script>
</div>
</body>
</html>